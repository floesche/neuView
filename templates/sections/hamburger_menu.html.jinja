{#
Hamburger Menu Component
========================

This template generates the hamburger menu for section navigation in neuron pages.

Features:
- Responsive navigation menu that appears on all screen sizes
- Soma side switching buttons (L/R/C/M) when multiple hemispheres available
- Dynamic section links based on available page content
- Smooth scrolling to page sections
- Mobile-friendly hover and click interactions

Usage:
- Included separately in parent templates alongside neuron_header.html.jinja
- For neuron pages: include both hamburger_menu.html.jinja and neuron_header.html.jinja
- For index/help pages: include only header.html.jinja (no hamburger menu)
- Requires context variables: neuron_type, soma_side, soma_side_links
- Optional: layer_analysis, column_analysis, neuroglancer_url, roi_summary, connectivity

CSS Classes:
- .hamburger-menu: Main container
- .hamburger-btn: Toggle button (hidden on large screens)
- .hamburger-dropdown: Navigation dropdown
- .hamburger-link: Navigation links
- .soma-button-container: Hemisphere switching buttons

JavaScript:
- Handled by initializeResponsiveNavigation() in neuron-page.js
- Auto-shows on large screens (1700px+), toggle on smaller screens
#}

{# Generate section links based on available data #}
{% set section_links = [] %}

{# Layer Analysis section #}
{% if soma_side != 'combined' and layer_analysis and layer_analysis.containers and (layer_analysis.containers.la.columns or layer_analysis.containers.me.columns or layer_analysis.containers.lo.columns or layer_analysis.containers.lop.columns or layer_analysis.containers.ame.columns or layer_analysis.containers.central_brain.columns) %}
  {% set _ = section_links.append(('layer-stats', 'Mean Synapse Count per Layer')) %}
{% endif %}

{# Population Spatial Coverage section #}
{% if column_analysis and column_analysis.comprehensive_region_grids %}
  {% set _ = section_links.append(('eyemaps', 'Population Spatial Coverage')) %}
{% endif %}

{# Neuron Visualization section - always present if neuroglancer_url exists #}
{% if neuroglancer_url %}
  {% set _ = section_links.append(('neuron-visualization', 'Neuron Visualization')) %}
{% endif %}

{# ROI Innervation section - clean the bracket content #}
{% if roi_summary and roi_summary|length > 0 %}
  {% set _ = section_links.append(('roi-innervation', 'ROI Innervation')) %}
{% endif %}

{# Connectivity section #}
{% if connectivity and (connectivity.upstream or connectivity.downstream) %}
  {% set _ = section_links.append(('s-c', 'Connectivity')) %}
{% endif %}

<div class="hamburger-menu" id="hamburgerMenu">
  <button class="hamburger-btn" id="hamburgerBtn" aria-label="Jump to section menu">
    <span class="hamburger-icon">&#9776;</span>
  </button>
  <nav class="hamburger-dropdown" id="hamburgerDropdown">
    {% if soma_side_links and soma_side_links|length > 0 %}
    <div class="hamburger-title">
      <a href="#top" class="hamburger-link">{{ neuron_type }}{% if soma_side and soma_side != '' and soma_side != 'combined' %} ({{ soma_side[0]|upper }}){% endif %}</a>
    </div>
    <div class="soma-button-container">
      {% set current_side_normalized = soma_side|lower if soma_side else '' %}
      {% set sides_order = ['right', 'middle', 'combined', 'left'] %}
      {% set letter_map = {'left': 'L', 'middle': 'M', 'combined': 'C', 'right': 'R'} %}
      {% for side in sides_order %}
        {% if side in soma_side_links or side == current_side_normalized or side == soma_side %}
          {% set is_current = (side == current_side_normalized or side == soma_side) %}
          {% if is_current %}
          <span class="soma-button soma-button-{{ side }} soma-button-current" title="Current: {{ side|title }}">{{ letter_map[side] }}</span>
          {% else %}
          <a href="{{ soma_side_links[side] }}" class="soma-button soma-button-{{ side }}" title="Switch to {{ side|title }}">{{ letter_map[side] }}</a>
          {% endif %}
        {% endif %}
      {% endfor %}
    </div>
    {% else %}
    <div class="hamburger-title">
      <a href="#cell-type-catalog">{{ neuron_type }}{% if soma_side and soma_side != '' and soma_side != 'combined' %} ({{ soma_side[0]|upper }}){% endif %}</a>
    </div>
    {% endif %}

    {# Add section links from template data #}
    {% for section_id, section_title in section_links %}
    <a href="#{{ section_id }}" class="hamburger-link">{{ section_title }}</a>
    {% endfor %}
  </nav>
</div>
